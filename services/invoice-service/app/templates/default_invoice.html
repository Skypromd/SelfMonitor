<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Invoice {{ invoice.invoice_number }}</title>\n    <style>\n        @page {\n            size: A4;\n            margin: 2cm;\n            @bottom-right {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-size: 10pt;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            font-size: 11pt;\n            line-height: 1.4;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        \n        .header {\n            margin-bottom: 30px;\n            display: flex;\n            justify-content: space-between;\n        }\n        \n        .company-info {\n            text-align: right;\n        }\n        \n        .company-name {\n            font-size: 20pt;\n            font-weight: bold;\n            color: #2c3e50;\n            margin-bottom: 10px;\n        }\n        \n        .invoice-title {\n            font-size: 28pt;\n            font-weight: bold;\n            color: #e74c3c;\n            margin-bottom: 20px;\n        }\n        \n        .invoice-details {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 30px;\n        }\n        \n        .client-info {\n            max-width: 45%;\n        }\n        \n        .invoice-meta {\n            text-align: right;\n        }\n        \n        .invoice-meta table {\n            margin-left: auto;\n        }\n        \n        .invoice-meta td {\n            padding: 3px 8px;\n            border-bottom: 1px solid #ecf0f1;\n        }\n        \n        .invoice-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 30px;\n        }\n        \n        .invoice-table th {\n            background-color: #34495e;\n            color: white;\n            padding: 12px 8px;\n            text-align: left;\n            font-weight: bold;\n        }\n        \n        .invoice-table td {\n            padding: 10px 8px;\n            border-bottom: 1px solid #ecf0f1;\n        }\n        \n        .invoice-table tr:nth-child(even) {\n            background-color: #f8f9fa;\n        }\n        \n        .text-right {\n            text-align: right;\n        }\n        \n        .text-center {\n            text-align: center;\n        }\n        \n        .totals-table {\n            width: 300px;\n            margin-left: auto;\n            margin-bottom: 30px;\n        }\n        \n        .totals-table td {\n            padding: 8px 12px;\n            border-bottom: 1px solid #ecf0f1;\n        }\n        \n        .total-row {\n            background-color: #34495e;\n            color: white;\n            font-weight: bold;\n            font-size: 12pt;\n        }\n        \n        .payment-info {\n            background-color: #f8f9fa;\n            padding: 20px;\n            border-left: 4px solid #3498db;\n            margin-bottom: 20px;\n        }\n        \n        .overdue-notice {\n            background-color: #fff5f5;\n            border: 2px solid #e74c3c;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 4px;\n        }\n        \n        .footer {\n            margin-top: 40px;\n            padding-top: 20px;\n            border-top: 2px solid #34495e;\n            font-size: 9pt;\n            color: #666;\n        }\n        \n        .qr-code {\n            float: right;\n            margin-left: 20px;\n        }\n        \n        .currency {\n            font-family: 'Courier New', monospace;\n        }\n        \n        .highlight {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 10px 0;\n        }\n    </style>\n</head>\n<body>\n    <!-- Header -->\n    <div class=\"header\">\n        <div class=\"logo\">\n            {% if company.logo_url %}\n                <img src=\"{{ company.logo_url }}\" alt=\"{{ company.name }}\" style=\"max-height: 80px;\">\n            {% endif %}\n        </div>\n        <div class=\"company-info\">\n            <div class=\"company-name\">{{ company.name }}</div>\n            <div>{{ company.address }}</div>\n            <div>{{ company.city }}, {{ company.postal_code }}</div>\n            <div>{{ company.country }}</div>\n            {% if company.phone %}<div>Tel: {{ company.phone }}</div>{% endif %}\n            {% if company.email %}<div>Email: {{ company.email }}</div>{% endif %}\n            {% if company.vat_number %}<div>VAT: {{ company.vat_number }}</div>{% endif %}\n        </div>\n    </div>\n    \n    <!-- Invoice Title -->\n    <div class=\"invoice-title\">INVOICE</div>\n    \n    <!-- Overdue Notice -->\n    {% if is_overdue %}\n    <div class=\"overdue-notice\">\n        <strong>OVERDUE NOTICE:</strong> This invoice is {{ aging_days }} days overdue. Please arrange payment immediately to avoid late fees.\n    </div>\n    {% endif %}\n    \n    <!-- Invoice Details -->\n    <div class=\"invoice-details\">\n        <div class=\"client-info\">\n            <h3>Bill To:</h3>\n            <strong>{{ invoice.client_name }}</strong><br>\n            {% if invoice.client_email %}{{ invoice.client_email }}<br>{% endif %}\n            {% if invoice.client_address %}\n                {{ invoice.client_address | replace('\\n', '<br>')|safe }}\n            {% endif %}\n        </div>\n        <div class=\"invoice-meta\">\n            <table>\n                <tr><td><strong>Invoice Number:</strong></td><td>{{ invoice.invoice_number }}</td></tr>\n                <tr><td><strong>Invoice Date:</strong></td><td>{{ invoice.invoice_date | date }}</td></tr>\n                {% if invoice.due_date %}<tr><td><strong>Due Date:</strong></td><td>{{ invoice.due_date | date }}</td></tr>{% endif %}\n                {% if invoice.po_number %}<tr><td><strong>PO Number:</strong></td><td>{{ invoice.po_number }}</td></tr>{% endif %}\n                <tr><td><strong>Status:</strong></td><td>{{ invoice.status.value.title() }}</td></tr>\n                <tr><td><strong>Currency:</strong></td><td>{{ invoice.currency }}</td></tr>\n            </table>\n        </div>\n    </div>\n    \n    <!-- Line Items -->\n    <table class=\"invoice-table\">\n        <thead>\n            <tr>\n                <th>Description</th>\n                <th class=\"text-center\">Qty</th>\n                <th class=\"text-right\">Unit Price</th>\n                <th class=\"text-right\">Tax Rate</th>\n                <th class=\"text-right\">Amount</th>\n            </tr>\n        </thead>\n        <tbody>\n            {% for item in invoice.line_items %}\n            <tr>\n                <td>\n                    {{ item.description }}\n                    {% if item.category %}<br><small style=\"color: #666;\">{{ item.category }}</small>{% endif %}\n                </td>\n                <td class=\"text-center\">{{ item.quantity }}</td>\n                <td class=\"text-right currency\">{{ item.unit_price | currency(invoice.currency) }}</td>\n                <td class=\"text-right\">{% if item.tax_rate %}{{ item.tax_rate | percentage }}{% else %}-{% endif %}</td>\n                <td class=\"text-right currency\">{{ item.total_amount | currency(invoice.currency) }}</td>\n            </tr>\n            {% endfor %}\n        </tbody>\n    </table>\n    \n    <!-- Totals -->\n    <table class=\"totals-table\">\n        <tr>\n            <td><strong>Subtotal:</strong></td>\n            <td class=\"text-right currency\">{{ invoice.subtotal | currency(invoice.currency) }}</td>\n        </tr>\n        {% if invoice.discount_amount and invoice.discount_amount > 0 %}\n        <tr>\n            <td>Discount ({{ invoice.discount_percentage }}%):</td>\n            <td class=\"text-right currency\">-{{ invoice.discount_amount | currency(invoice.currency) }}</td>\n        </tr>\n        {% endif %}\n        <tr>\n            <td><strong>Tax (VAT):</strong></td>\n            <td class=\"text-right currency\">{{ invoice.tax_amount | currency(invoice.currency) }}</td>\n        </tr>\n        <tr class=\"total-row\">\n            <td><strong>Total:</strong></td>\n            <td class=\"text-right currency\">{{ invoice.total_amount | currency(invoice.currency) }}</td>\n        </tr>\n        {% if invoice.paid_amount and invoice.paid_amount > 0 %}\n        <tr>\n            <td>Amount Paid:</td>\n            <td class=\"text-right currency\">-{{ invoice.paid_amount | currency(invoice.currency) }}</td>\n        </tr>\n        <tr class=\"total-row\">\n            <td><strong>Balance Due:</strong></td>\n            <td class=\"text-right currency\">{{ (invoice.total_amount - invoice.paid_amount) | currency(invoice.currency) }}</td>\n        </tr>\n        {% endif %}\n    </table>\n    \n    <!-- Payment Information -->\n    <div class=\"payment-info\">\n        <h3>Payment Information</h3>\n        <p><strong>Payment Terms:</strong> {% if invoice.payment_terms %}Net {{ invoice.payment_terms }} days{% else %}Payment due on receipt{% endif %}</p>\n        \n        {% if company.bank_details %}\n        <p><strong>Bank Transfer Details:</strong><br>\n        {{ company.bank_details | replace('\\n', '<br>')|safe }}\n        </p>\n        {% endif %}\n        \n        <p><strong>Online Payment:</strong> <a href=\"{{ payment_url }}\">{{ payment_url }}</a></p>\n        \n        <div class=\"qr-code\">\n            <img src=\"{{ qr_code_url }}\" alt=\"QR Code for payment\" style=\"width: 100px; height: 100px;\">\n            <br><small>Scan to pay</small>\n        </div>\n    </div>\n    \n    <!-- UK Self-Employed Notice -->\n    <div class=\"highlight\">\n        <p><strong>Important for UK Self-Employed Clients:</strong><br>\n        This invoice can be used as supporting documentation for your HMRC Self Assessment. \n        For mortgage applications, this invoice demonstrates professional income from {{ invoice.invoice_date | date }} \n        and forms part of your 12-month income history.</p>\n    </div>\n    \n    <!-- Notes -->\n    {% if invoice.notes %}\n    <div style=\"margin-bottom: 30px;\">\n        <h3>Additional Notes</h3>\n        <p>{{ invoice.notes | replace('\\n', '<br>')|safe }}</p>\n    </div>\n    {% endif %}\n    \n    <!-- Footer -->\n    <div class=\"footer\">\n        <div style=\"display: flex; justify-content: space-between;\">\n            <div>\n                <p>Thank you for your business!</p>\n                <p><strong>Questions?</strong> Contact us at {{ company.email }} or {{ company.phone }}</p>\n            </div>\n            <div style=\"text-align: right;\">\n                <p>Generated on {{ generated_at | date(\"%d %B %Y at %H:%M\") }}</p>\n                <p>SelfMonitor Invoice System</p>\n            </div>\n        </div>\n    </div>\n</body>\n</html>"