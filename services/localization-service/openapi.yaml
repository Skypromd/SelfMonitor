openapi: 3.0.3
info:
  title: Localization Service
  description: Provides translation strings (i18n) for different locales from external JSON catalogs.
  version: 1.0.0
paths:
  /translations/locales:
    get:
      summary: List supported locales and fallback policy
      tags:
        - Translations
      responses:
        '200':
          description: Supported locale catalog for scalable i18n rollout.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SupportedLocale'
  /translations/health:
    get:
      summary: Get translation health telemetry across locales
      tags:
        - Translations
      responses:
        '200':
          description: Translation health metrics including fallback hit-rate and missing key samples.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslationHealthResponse'
  /translations/{locale}/all:
    get:
      summary: Get all translations for a locale
      tags:
        - Translations
      parameters:
        - name: locale
          in: path
          required: true
          schema:
            type: string
            example: 'en-GB'
          description: The locale for the translations (e.g., 'en-GB', 'de-DE').
      responses:
        '200':
          description: A nested object of all translations for the locale.
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
                  additionalProperties:
                    type: string
        '404':
          description: Translations not found for the given locale.
  /translations/{locale}/{component}:
    get:
      summary: Get translations for a component
      deprecated: true
      tags:
        - Translations
      parameters:
        - name: locale
          in: path
          required: true
          schema:
            type: string
            example: 'en-GB'
          description: The locale for the translations (e.g., 'en-GB', 'de-DE').
        - name: component
          in: path
          required: true
          schema:
            type: string
            example: 'login'
          description: The component or namespace for the translations.
      responses:
        '200':
          description: A key-value map of translations.
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: string
                example:
                  title: 'FinTech App'
                  description: 'Register or log in to continue'
        '404':
          description: Translations not found for the given locale or component.

components:
  schemas:
    SupportedLocale:
      type: object
      properties:
        code:
          type: string
          example: ru-RU
        native_name:
          type: string
          example: Русский
        fallback_locale:
          type: string
          nullable: true
          example: en-GB
        status:
          type: string
          example: fallback_en_gb
      required:
        - code
        - native_name
        - status
    TranslationLocaleHealth:
      type: object
      properties:
        code:
          type: string
          example: ru-RU
        status:
          type: string
          example: fallback_en_gb
        total_reference_keys:
          type: integer
        localized_keys:
          type: integer
        fallback_keys:
          type: integer
        estimated_fallback_hit_rate_percent:
          type: number
          format: float
          example: 100.0
        fully_untranslated_namespaces_count:
          type: integer
        partially_translated_namespaces_count:
          type: integer
        missing_key_count:
          type: integer
        missing_key_samples:
          type: array
          items:
            type: string
      required:
        - code
        - status
        - total_reference_keys
        - localized_keys
        - fallback_keys
        - estimated_fallback_hit_rate_percent
        - fully_untranslated_namespaces_count
        - partially_translated_namespaces_count
        - missing_key_count
        - missing_key_samples
    TranslationHealthSummary:
      type: object
      properties:
        total_locales:
          type: integer
        locales_with_fallback:
          type: integer
        average_fallback_hit_rate_percent:
          type: number
          format: float
        highest_fallback_locale:
          type: string
          nullable: true
        highest_fallback_hit_rate_percent:
          type: number
          format: float
      required:
        - total_locales
        - locales_with_fallback
        - average_fallback_hit_rate_percent
        - highest_fallback_hit_rate_percent
    TranslationHealthResponse:
      type: object
      properties:
        generated_at:
          type: string
          format: date-time
        default_locale:
          type: string
          example: en-GB
        reference_total_keys:
          type: integer
        locales:
          type: array
          items:
            $ref: '#/components/schemas/TranslationLocaleHealth'
        summary:
          $ref: '#/components/schemas/TranslationHealthSummary'
      required:
        - generated_at
        - default_locale
        - reference_total_keys
        - locales
        - summary
