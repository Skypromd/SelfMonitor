# Дорожная карта к 101%: От эталонной архитектуры к промышленному идеалу
**Дата документа:** 2025-10-04

Созданный проект является образцовой архитектурой. Следующие шаги — это путь к превращению его в продукт, соответствующий высочайшим стандартам технологических компаний (FAANG).

### 1. API Management: Внедрение API Gateway (РЕАЛИЗОВАНО)

- **Проблема:** Фронтенд напрямую обращался к десяткам микросервисов, что усложняло безопасность, CORS и управление API.
- **Решение "101%":** **Создана единая точка входа через API Gateway на базе NGINX.**
- **Как это работает:**
    1. Все запросы от фронтенда теперь идут на один адрес: `http://localhost:8000/api`.
    2. NGINX-шлюз анализирует URL (например, `/api/auth/token`) и перенаправляет запрос на соответствующий внутренний микросервис (`auth-service`).
    3. Прямой доступ к портам микросервисов извне закрыт, что значительно повышает безопасность.
- **Результат:** Внутренние сервисы полностью изолированы. Управление API централизовано. Конфигурация фронтенда радикально упрощена.

### 2. Developer Experience: Автоматическая генерация клиентов

- **Проблема:** Межсервисные вызовы пишутся вручную (`httpx.get(...)`), что создаёт риск ошибок при изменении API.
- **Решение "101%":** **Автоматическая кодогенерация типизированных клиентов.**
- **План действий:**
  1.  Создать скрипт в директории `/tools`.
  2.  Этот скрипт должен брать `openapi.yaml` спецификации каждого сервиса.
  3.  На их основе генерировать Python-клиенты (для бэкенда) и TypeScript-клиенты (для фронтенда).
  4.  Рефакторинг кода сервисов для использования этих клиентов вместо ручных `httpx` запросов.
- **Результат:** Полная безопасность типов между сервисами. Ошибка изменения API обнаруживается на этапе компиляции, а не в продакшене. **РЕАЛИЗОВАНО для связки tax-engine -> transactions-service.**

### 3. Deployment: Переход на Kubernetes и GitOps

- **Проблема:** `docker-compose` не предназначен для управления приложениями в продакшене.
- **Решение "101%":** **Развёртывание через Kubernetes с использованием GitOps-подхода.**
- **План действий:**
  1.  Создать **Helm-чарты** для каждого сервиса в директории `/infra/k8s/`.
  2.  Настроить в облаке Kubernetes-кластер.
  3.  Настроить инструмент **ArgoCD** или **Flux**, который будет отслеживать изменения в директории `/infra/k8s/` в Git и автоматически применять их к кластеру.
- **Результат:** Полностью автоматизированный, декларативный и отказоустойчивый процесс развёртывания, соответствующий лучшим мировым практикам.

### 4. CI/CD: Построение "Конвейера качества"

- **Проблема:** Текущий CI-пайплайн выполняет только базовые проверки.
- **Решение "101%":** **Создание многоэтапного CI/CD пайплайна.**
- **План действий:**
  1.  Расширить файл `.github/workflows/ci.yaml`.
  2.  Добавить в него следующие шаги, которые будут выполняться для каждого Pull Request:
      - **Lint & Format:** Проверка стиля кода (`black`, `flake8`, `eslint`).
      - **Static Analysis:** Поиск потенциальных ошибок (`mypy`).
      - **Security Scan:** Сканирование зависимостей на уязвимости (`trivy`, `snyk`).
      - **Build & Push:** Сборка Docker-образов и их отправка в репозиторий (например, Docker Hub).
      - **Integration Tests:** Запуск наших интеграционных тестов из папки `/tests/`.
- **Результат:** Гарантия высочайшего качества и безопасности кода. Ни одно изменение, не прошедшее все проверки, не сможет попасть в основную ветку.

---
Реализация этих четырёх пунктов превратит проект в безупречное инженерное решение.
