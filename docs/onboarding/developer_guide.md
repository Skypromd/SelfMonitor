# Руководство для разработчика (Developer Onboarding Guide)
**Версия:** 1.0
**Дата:** 2025-10-04

Добро пожаловать в проект! Это руководство поможет вам быстро погрузиться в архитектуру, настроить рабочее окружение и начать вносить свой вклад.

## 1. Обзор проекта и архитектуры

Этот проект — облачная FinTech-платформа, построенная на **микросервисной архитектуре**. Мы используем подход "правильный инструмент для правильной задачи", что отражено в нашем технологическом стеке.

- **Backend:** 15+ изолированных сервисов на **Python/FastAPI**.
- **Frontend:** Многостраничное приложение на **Next.js/TypeScript**.
- **Базы данных:** Мы используем несколько хранилищ:
    - **PostgreSQL:** для основных реляционных данных.
    - **Redis:** как брокер сообщений для фоновых задач.
    - **Weaviate:** для векторного поиска (AI).
    - **AWS S3 (LocalStack):** для хранения файлов.
    - **Vault:** для безопасного хранения секретов.
- **Асинхронные задачи:** Используется **Celery** для надёжной обработки фоновых операций.
- **Взаимодействие:** Сервисы общаются друг с другом через REST API, контракты которых описаны в **OpenAPI**.

## 2. Быстрый старт: Первый запуск

### Пререквизиты
1.  **Docker** и **Docker Compose:** Вся наша система запускается в контейнерах.
2.  **Node.js** и **npm/yarn:** для запуска фронтенд-приложения в режиме разработки.
3.  **Git:** для контроля версий.

### Запуск системы (One-Command-Start)

1.  **Запустите бэкенд и инфраструктуру:**
    Из корневой директории проекта выполните команду:
    ```bash
    docker-compose up --build
    ```
    Эта команда запустит все 17+ контейнеров (сервисы, базы данных, мониторинг). **Дождитесь, пока все сервисы успешно запустятся.** Первоначальная сборка может занять несколько минут.

2.  **Запустите фронтенд:**
    В **новом окне терминала** перейдите в директорию веб-портала и запустите его:
    ```bash
    cd apps/web-portal
    npm install
    npm run dev
    ```

3.  **Откройте приложение:**
    - **Основное приложение:** `http://localhost:3000`
    - **Grafana (Мониторинг):** `http://localhost:3001` (логин/пароль: `admin`/`admin`)
    - **Prometheus:** `http://localhost:9090`
    - **Vault UI:** `http://localhost:8200` (токен для входа: `dev-root-token`)

## 3. Структура проекта

- `/.github/workflows/`: CI-пайплайны (проверка кода, тесты).
- `/apps/`: Фронтенд-приложения (`web-portal`, `mobile`).
- `/changelog/`: Журнал всех важных изменений в проекте.
- `/docs/`: Проектная документация (PRD, DPIA, архитектурные обзоры).
- `/grafana/`: Конфигурация дашбордов и источников данных для Grafana.
- `/infra/`: Код инфраструктуры (Terraform).
- `/libs/`: Общие библиотеки Python/TypeScript, используемые несколькими сервисами.
- `/ml/`: Скрипты для обучения ML-моделей.
- `/services/`: Исходный код всех наших микросервисов.
- `/tests/`: **Интеграционные тесты**, проверяющие взаимодействие всей системы.

## 4. Рабочий процесс разработчика

### Работа с отдельным сервисом
Каждый сервис в `/services/*` — это независимое FastAPI-приложение.
- **Зависимости:** Управляются через `requirements.txt` внутри каждого сервиса.
- **Тесты:** Юнит-тесты находятся в папке `tests/` внутри каждого сервиса и запускаются командой `pytest`.
- **Миграции БД:** Сервисы, работающие с PostgreSQL, используют **Alembic**. Для создания новой миграции:
  ```bash
  # Находясь в папке сервиса, например, services/user-profile-service
  alembic revision --autogenerate -m "add_new_field_to_user"
  ```
  Миграции применяются автоматически при старте `docker-compose`.

### Контрактное тестирование
Мы используем **Pact**.
1.  Сначала запускается consumer-тест (например, в `tax-engine`), который генерирует JSON-контракт.
2.  Затем запускается provider-тест (в `transactions-service`), который проверяет соответствие этому контракту.

### Интеграционное тестирование
Тесты в папке `/tests/integration` проверяют всю систему в сборе. Они запускаются командой `pytest` из корня проекта и делают реальные HTTP-запросы к запущенным в Docker сервисам.

## 5. Обзор ключевых архитектурных решений

- **Observability (Grafana + Prometheus + Loki):** Наш "центр управления полётами". Позволяет в одном месте видеть метрики, логи и в будущем — трейсы от всех сервисов.
- **Celery + Redis:** Обеспечивают надёжность. Если пользователь загрузил документ, а сервис упал — задача на обработку не потеряется, а будет выполнена, как только сервис поднимется.
- **Weaviate:** Наш "AI-мозг". Позволяет нам реализовывать функции семантического поиска, которые являются мощным конкурентным преимуществом.
- **Vault:** Наш "сейф". Хранит самые чувствительные данные, обеспечивая безопасность промышленного уровня.

---
Этот документ — живой. Пожалуйста, поддерживайте его в актуальном состоянии при внесении новых архитектурных изменений.
