# Default values for SelfMonitor Kafka Helm Chart
# This is a YAML-formatted file.

global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: "fast-ssd"

# Environment configuration
environment: production

# Namespace configuration
namespace:
  create: true
  name: kafka

# Zookeeper configuration
zookeeper:
  enabled: true
  replicaCount: 3
  image:
    registry: docker.io
    repository: confluentinc/cp-zookeeper
    tag: "7.4.0"
    pullPolicy: IfNotPresent
  
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  
  persistence:
    enabled: true
    storageClass: ""
    size: 10Gi
    
  config:
    tickTime: 2000
    initLimit: 10
    syncLimit: 5
    clientPort: 2181

# Kafka configuration
kafka:
  enabled: true
  replicaCount: 3
  image:
    registry: docker.io
    repository: confluentinc/cp-kafka
    tag: "7.4.0"
    pullPolicy: IfNotPresent
  
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m" 
    limits:
      memory: "2Gi"
      cpu: "1000m"
      
  persistence:
    enabled: true
    storageClass: ""
    size: 50Gi
    
  config:
    numPartitions: 12
    defaultReplicationFactor: 3
    minInsyncReplicas: 2
    offsetsTopicReplicationFactor: 3
    transactionStateLogReplicationFactor: 3
    transactionStateLogMinIsr: 2
    logRetentionHours: 168
    logRetentionBytes: 1073741824
    logSegmentBytes: 536870912
    compressionType: snappy
    
  jmx:
    enabled: true
    port: 9999

# Schema Registry configuration
schemaRegistry:
  enabled: true
  replicaCount: 2
  image:
    registry: docker.io
    repository: confluentinc/cp-schema-registry
    tag: "7.4.0"
    pullPolicy: IfNotPresent
    
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
      
  config:
    kafkastoreTopicReplicationFactor: 3
    schemaCompatibilityLevel: "BACKWARD"
    
  service:
    type: ClusterIP
    port: 8081

# Kafka Connect configuration
kafkaConnect:
  enabled: true
  replicaCount: 2
  image:
    registry: docker.io
    repository: confluentinc/cp-kafka-connect
    tag: "7.4.0"
    pullPolicy: IfNotPresent
    
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi" 
      cpu: "1000m"
      
  config:
    groupId: "selfmonitor-connect-cluster"
    offsetFlushIntervalMs: 10000
    configStorageReplicationFactor: 3
    offsetStorageReplicationFactor: 3
    statusStorageReplicationFactor: 3
    
  connectors:
    - confluentinc/kafka-connect-jdbc:10.7.4
    - debezium/debezium-connector-postgresql:2.2.1
    - confluentinc/kafka-connect-elasticsearch:14.0.10
    - mongo/kafka-connect-mongodb:1.11.0
    
  service:
    type: ClusterIP
    port: 8083

# KSQLDB configuration
ksqldb:
  enabled: true
  replicaCount: 2
  image:
    registry: docker.io
    repository: confluentinc/cp-ksqldb-server
    tag: "7.4.0"
    pullPolicy: IfNotPresent
    
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1000m"
      
  config:
    cacheMaxBytesBuffering: 0
    streamsReplicationFactor: 3
    internalTopicReplicas: 3
    internalTopicMinInsyncReplicas: 2
    
  service:
    type: ClusterIP
    port: 8088

# Kafka UI configuration
kafkaUI:
  enabled: true
  image:
    registry: docker.io
    repository: provectuslabs/kafka-ui
    tag: "latest"
    pullPolicy: IfNotPresent
    
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
      
  service:
    type: LoadBalancer
    port: 8080
    
  clusters:
    - name: "selfmonitor-cluster"
      bootstrapServers: "kafka-service:9092"
      
# Monitoring configuration
monitoring:
  enabled: true
  
  kafkaExporter:
    enabled: true
    image:
      registry: docker.io
      repository: danielqsj/kafka-exporter
      tag: "v1.7.0"
      pullPolicy: IfNotPresent
      
    resources:
      requests:
        memory: "64Mi"
        cpu: "50m"
      limits:
        memory: "128Mi"
        cpu: "100m"
        
    service:
      type: ClusterIP
      port: 9308
      
  jmxExporter:
    enabled: true
    image:
      registry: docker.io
      repository: sscaling/jmx-prometheus-exporter
      tag: "0.18.0"
      pullPolicy: IfNotPresent
      
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
      limits:
        memory: "256Mi"
        cpu: "100m"
        
    service:
      type: ClusterIP
      port: 8080
      
  prometheus:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
      
  grafana:
    enabled: true
    dashboards:
      enabled: true
      
  alerts:
    enabled: true
    rules:
      - name: "kafka-broker-down"
        severity: "critical"
        threshold: 1
      - name: "kafka-consumer-lag"
        severity: "warning"
        threshold: 1000
      - name: "kafka-disk-usage"
        severity: "warning"
        threshold: 0.8

# Security configuration
security:
  enabled: false
  authentication:
    type: "SASL_PLAINTEXT"
    sasl:
      mechanism: "SCRAM-SHA-512"
      users: []
  authorization:
    enabled: false
    type: "simple"
  encryption:
    enabled: false
    tls:
      keystorePassword: ""
      truststorePassword: ""

# Topic configuration
topics:
  autoCreate: true
  list:
    - name: "user.events"
      partitions: 12
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "604800000"
    - name: "transaction.events" 
      partitions: 12
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "2592000000"
    - name: "fraud.alerts"
      partitions: 8
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "7776000000"
    - name: "ml.predictions"
      partitions: 8
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "604800000"
    - name: "analytics.events"
      partitions: 12
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "2592000000"
    - name: "audit.events"
      partitions: 6
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "31536000000"
    - name: "notification.events"
      partitions: 6
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "604800000"
    - name: "document.events"
      partitions: 6
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "2592000000"
    - name: "compliance.events"
      partitions: 4
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "31536000000"
    - name: "integration.events"
      partitions: 8
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "604800000"
    - name: "system.events"
      partitions: 4
      replicationFactor: 3
      config:
        "cleanup.policy": "delete"
        "retention.ms": "2592000000"

# Node selector and tolerations
nodeSelector: {}
tolerations: []
affinity: {}

# Pod disruption budget
podDisruptionBudget:
  enabled: true
  minAvailable: 2

# Network policies
networkPolicy:
  enabled: true
  ingress:
    allowedNamespaces:
      - selfmonitor
      - monitoring
  egress:
    allowExternal: true

# Service account
serviceAccount:
  create: true
  name: "kafka-service-account"
  annotations: {}

# Priority class
priorityClassName: "high-priority"

# HorizontalPodAutoscaler
autoscaling:
  enabled: false
  minReplicas: 3
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80