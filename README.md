# Monorepo Project

Этот репозиторий содержит полный код для проекта, как описано в архитектурном документе.

## Структура репозитория

- **/apps**: Фронтенд-приложения (веб и мобильные).
- **/services**: Бэкенд-микросервисы на Python (FastAPI).
- **/libs**: Общие библиотеки и модули (DTO, утилиты для БД).
- **/infra**: Код инфраструктуры (Terraform, Kubernetes).
- **/ml**: Модели машинного обучения и скрипты для их обслуживания.
- **/tools**: Вспомогательные скрипты для разработки.
- **/docs**: Документация проекта (PRD, DPIA).
- **/.github**: Конфигурации для CI/CD (GitHub Actions).

## Быстрый старт (с Docker Compose)

Самый простой способ запустить весь проект локально — использовать Docker Compose.

1.  **Запустите бэкенд:**
    Из корневой директории проекта выполните команду:
    ```bash
    cp .env.example .env
    docker-compose up --build
    ```
    Перед запуском заполните секреты в `.env` (JWT secret, DB password, Vault/Weaviate credentials). Эта команда соберёт образы для всех сервисов и запустит их вместе с базой данных PostgreSQL. Backend-сервисы будут доступны по адресам `http://localhost:8000`, `http://localhost:8001` и так далее.

2.  **Запустите фронтенд:**
    В **новом окне терминала** перейдите в директорию веб-портала и запустите его:
    ```bash
    cd apps/web-portal
    npm install
    npm run dev
    ```

3.  **Откройте приложение:**
    Откройте в браузере `http://localhost:3000`. Вы должны увидеть страницу регистрации/входа.

## Запуск отдельных сервисов

Каждый сервис в директории `services` является независимым приложением. Для запуска отдельного сервиса:

1.  Перейдите в директорию сервиса, например, `cd services/auth-service`.
2.  Установите зависимости: `pip install -r requirements.txt`.
3.  Запустите сервер: `uvicorn app.main:app --reload`.

Для получения дополнительной информации обратитесь к `README.md` внутри каждого сервиса.

## Клиентская демонстрация

Для стабильного сценария показа используйте runbook:  
`docs/runbooks/client_demo_runbook.md`

## Тестирование

Каждый сервис должен содержать свои собственные тесты в директории `tests/`. Тесты написаны с использованием `pytest`.

Чтобы запустить тесты для конкретного сервиса:

1.  Перейдите в директорию сервиса, например, `cd services/auth-service`.
2.  Убедитесь, что установлены зависимости для тестирования (они включены в `requirements.txt`).
3.  Запустите pytest: `pytest`.

CI-пайплайн, настроенный в `.github/workflows/ci.yaml`, также автоматически запускает эти тесты при внесении изменений.

### Интеграционные тесты

Интеграционные тесты в `tests/integration` запускаются только при наличии
запущенных сервисов (через Docker Compose) и явного флага.

Чтобы запустить их локально:

1. Поднимите сервисы через `docker-compose up --build`.
2. Установите переменную окружения:
   ```bash
   export RUN_INTEGRATION_TESTS=1
   ```
3. Запустите pytest из корня:
   ```bash
   pytest
   ```